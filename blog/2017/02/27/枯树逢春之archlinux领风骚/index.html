<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>枯树逢春之ArchLinux领风骚 - 陌上人如玉,公子世无双</title>
  <meta charset="utf-8" />
  <meta name="author" content="Samray" />
  <meta name="description" content="An description about how to install arch linux in an old machine" />
  <meta name="keywords" content="archlinux,linux" />

  <link rel="alternate" title="RSS Feed" href="/rss.xml" type="application/rss+xml">
  <link rel="stylesheet" href="/media/css/main.css" type="text/css">
  <link rel="stylesheet" href="/media/css/posts.css" type="text/css">
</head>

  <body class="container">
<header id="header">
<body>
    <nav class="navbar navbar-default navbar-fixed-top" style="opacity: .9" role="navigation">
        <div class="container-fluid">
<div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">陌上人如玉,公子世无双</a>
        </div>
<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="active"><a href="/">Blog</a></li>
          <li><a href="https://github.com/samrayleung">GitHub</a></li>
        </ul>
</div>
</div>
    </nav>
</body>
</header>

<section id="content" role="main">
    <div id="outline-container-sec-" class="row" style="padding-top: 70px">
        <div class="col-md-2"></div>
            <h1>枯树逢春之ArchLinux领风骚</h1>
            <div id="outline-container-orgf5d1998" class="outline-2">
<h2 id="orgf5d1998">枯树</h2>
<div class="outline-text-2" id="text-orgf5d1998">
<p>
周末回了一趟家，没带自己的笔记本，在家闲来无事，无意中看到墙角的电脑，已经尘封
已久反正无事，何不玩玩这台老古董呢？于是把电脑拿去修理店把坏了的硬件修好。离开
店的时候，老板说：“你的系统有问题，笔者看到你自己也有Ghost,就不帮搞这系统了，
你自己都能解决的，推荐你还是用XP吧，这电脑配置低，还是XP好用”。笔者忍不住回头
对老板一笑 :)
</p>
</div>
</div>
<div id="outline-container-orgf021dfe" class="outline-2">
<h2 id="orgf021dfe">春至</h2>
<div class="outline-text-2" id="text-orgf021dfe">
<p>
像笔者这种Linuxer,这么可能再装回XP呢，最初装Win7,也是考虑到老爹的技术 hold 不
住 Linux,现在手机那么发达，他就不需要电脑了，所以，此时不装Linux,更待何时呢？
</p>
</div>
</div>
<div id="outline-container-org3548732" class="outline-2">
<h2 id="org3548732">Arch Linux</h2>
<div class="outline-text-2" id="text-org3548732">
<p>
笔者没有选择 Xubuntu 这种适合老机器的 Ubuntu 衍生发行版本，因为笔者不喜欢
 Ubuntu, 所以笔者最后选择的是 Arch linux,官网说最低配置只需500MB内存，800MB的
 硬盘存储空间，正适合家里的老家伙
</p>
</div>
<div id="outline-container-orgfc544a8" class="outline-3">
<h3 id="orgfc544a8">安装过程</h3>
<div class="outline-text-3" id="text-orgfc544a8">
</div><div id="outline-container-org783fe29" class="outline-4">
<h4 id="org783fe29">下载镜像</h4>
<div class="outline-text-4" id="text-org783fe29">
<p>
<a href="https://www.archlinux.org/download/">Download Link</a> ,在网易的镜像下载ISO, 然后用dd刻录到U盘，Windows 可以选择
<a href="http://sourceforge.net/projects/usbwriter">USBwriter</a>
</p>
</div>
</div>
<div id="outline-container-org1754fc9" class="outline-4">
<h4 id="org1754fc9">分区</h4>
<div class="outline-text-4" id="text-org1754fc9">
<p>
使用fdisk, 笔者的硬盘是/dev/sda,如果还有一块硬盘，那应该就是/dev/sdb
</p>
<div class="org-src-container">
<pre class="src src-shell">fdisk /dev/sda
</pre>
</div>
<ul class="org-ul">
<li>n:新建一个分区，p 指主分区，e 是指扩展分区(逻辑分区是建立在扩展分区上的)
一块硬盘主分区加上扩展分区最多只能是4个</li>
<li>d: 删除</li>
<li>m: 查询其他命令，不知道怎么操作就输入m 吧</li>
</ul>
<p>
分区结束以后，输入 <b>w</b> 完成分区 (笔者分了三个分区 /dev/sda1 -&gt; swap
/dev/sda2 -&gt; / /dev/sda3 -&gt; /home)
</p>
</div>
</div>
<div id="outline-container-orgb7a07a8" class="outline-4">
<h4 id="orgb7a07a8">格式化分区</h4>
<div class="outline-text-4" id="text-orgb7a07a8">
<p>
格式化 sda2 sda3为ext4格式：
</p>
<div class="org-src-container">
<pre class="src src-shell">mkfs.ext4 /dev/sda2
mkfs.ext4 /dev/sda3
</pre>
</div>
<p>
格式化sda1 为swap(虚拟内存),一般是内存的两倍，当然如果你的内存很大的话就不用
划这个分区了
</p>
<div class="org-src-container">
<pre class="src src-shell">mkswap /dev/sda1
</pre>
</div>
<p>
激活swap
</p>
<div class="org-src-container">
<pre class="src src-shell">swapon /dev/sda1
</pre>
</div>
</div>
</div>
<div id="outline-container-org62d5396" class="outline-4">
<h4 id="org62d5396">挂载</h4>
<div class="outline-text-4" id="text-org62d5396">
<p>
将sda2挂载到/mnt,其实就是让sda2分区做系统的根分区，/mnt/home同理
</p>
<div class="org-src-container">
<pre class="src src-shell">mount /dev/sda2 /mnt
mount /dev/sda3 /mnt/home
</pre>
</div>
</div>
</div>
<div id="outline-container-orgda717bd" class="outline-4">
<h4 id="orgda717bd">更新pacman源</h4>
<div class="outline-text-4" id="text-orgda717bd">
<p>
网易的源不错，编辑 <b>/etc/pacman.d/mirrorlist</b> 添加 <b>Server = <a href="http://mirrors.163.com/archlinux/$repo/os/$arch">http://mirrors.163.com/archlinux/$repo/os/$arch</a></b>
</p>
<div class="org-src-container">
<pre class="src src-shell">vim /etc/pacman.d/mirrorlist
</pre>
</div>
<p>
然后添加；
添加完之后，更新一下
</p>
<div class="org-src-container">
<pre class="src src-shell">pacman -Syy
</pre>
</div>
</div>
</div>
<div id="outline-container-org6712f3c" class="outline-4">
<h4 id="org6712f3c">安装基本系统</h4>
<div class="outline-text-4" id="text-org6712f3c">
<p>
安装基本系统到 /mnt,即sda2分区
</p>
<div class="org-src-container">
<pre class="src src-shell">pacstrap /mnt base base-devel
</pre>
</div>
<p>
需要安装的都安装吧，然后走开煮一杯咖啡，慢慢品尝
</p>
</div>
</div>
<div id="outline-container-orgf4827ce" class="outline-4">
<h4 id="orgf4827ce">生成fstab</h4>
<div class="outline-text-4" id="text-orgf4827ce">
<p>
fstab 的作用：
</p>
<blockquote>
<p>
The fstab(5) file can be used to define how disk partitions, various other
block devices, or remote filesystems should be mounted into the filesystem
</p>
</blockquote>
<p>
生成fstab,并且查看是否正确生成fstab
</p>
<div class="org-src-container">
<pre class="src src-shell">genfstab -U -p /mnt &gt;&gt; /mnt/etc/fstab
cat /mnt/etc/fstab
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdf0e6cd" class="outline-4">
<h4 id="orgdf0e6cd">配置系统</h4>
<div class="outline-text-4" id="text-orgdf0e6cd">
<p>
切换到新的系统，然后你会发现命令行提示符发生了改变
</p>
<pre class="example">
arch-chroot /mnt
</pre>
</div>
<ul class="org-ul"><li><a id="org0b3fa89"></a>设置地区<br /><div class="outline-text-5" id="text-org0b3fa89">
<div class="org-src-container">
<pre class="src src-shell">ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</pre>
</div>
</div></li>
<li><a id="org55c872f"></a>设置语言<br /><div class="outline-text-5" id="text-org55c872f">
<p>
编辑 <b>/etc/locale.gen</b>,因为该文件所有的信息都是被注释滴，所以在最上面添加
<b>en_US.UTF-8 UTF-8</b> 即可
</p>
<div class="org-src-container">
<pre class="src src-shell">vim /etc/locale.gen
</pre>
</div>
<p>
然后添加；
添加完成后，执行 <b>locale-gen</b>
</p>
<div class="org-src-container">
<pre class="src src-shell">locale-gen
</pre>
</div>
<p>
接着配置 <b>locale.conf</b>
</p>
<div class="org-src-container">
<pre class="src src-shell">echo LANG=en_US.UTF-8 &gt; /etc/locale.conf
export LANG=en_US.UTF-8
</pre>
</div>
</div></li>
<li><a id="org49c8d4b"></a>设置主机名<br /><div class="outline-text-5" id="text-org49c8d4b">
<div class="org-src-container">
<pre class="src src-shell">echo samray-arch &gt; /etc/hostname
</pre>
</div>
</div></li>
<li><a id="orgdf47653"></a>设置密码<br /><div class="outline-text-5" id="text-orgdf47653">
<div class="org-src-container">
<pre class="src src-shell">passwd
</pre>
</div>
</div></li>
<li><a id="orga7eb917"></a>配置网络<br /><div class="outline-text-5" id="text-orga7eb917">
<div class="org-src-container">
<pre class="src src-shell">pacman -S net-tools
systemctl enable dhcpcd.service
</pre>
</div>
</div></li>
<li><a id="orgf627bc6"></a>安装GRUB<br /><div class="outline-text-5" id="text-orgf627bc6">
<div class="org-src-container">
<pre class="src src-shell">pacman -S grub-bios
</pre>
</div>
<p>
把grub 安装到硬盘sda,如果双系统的话，还要视情况做更改
</p>
<div class="org-src-container">
<pre class="src src-shell">grub-install --recheck /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg
</pre>
</div>
</div></li></ul>
</div>
<div id="outline-container-org4fa6d9a" class="outline-4">
<h4 id="org4fa6d9a">收尾工作</h4>
<div class="outline-text-4" id="text-org4fa6d9a">
<div class="org-src-container">
<pre class="src src-shell">exit
umount /mnt/home
umount /mnt
reboot
</pre>
</div>
<p>
这样Arch linux 就装好了，不过你重启会发现，你的系统是没有图形化界面的
</p>
</div>
</div>
</div>
<div id="outline-container-orgd8fe8da" class="outline-3">
<h3 id="orgd8fe8da">安装桌面环境</h3>
<div class="outline-text-3" id="text-orgd8fe8da">
</div><div id="outline-container-orgd0bc571" class="outline-4">
<h4 id="orgd0bc571">安装x服务</h4>
<div class="outline-text-4" id="text-orgd0bc571">
<div class="org-src-container">
<pre class="src src-shell">pacman -S xorg-server xorg-server-utils xorg-xinit
</pre>
</div>
</div>
</div>
<div id="outline-container-orgee6ffc9" class="outline-4">
<h4 id="orgee6ffc9">安装显卡驱动</h4>
<div class="outline-text-4" id="text-orgee6ffc9">
<p>
查找自己的显卡类型
</p>
<div class="org-src-container">
<pre class="src src-shell">ispci |grep VGA
</pre>
</div>
<p>
然后搜索匹配自己显卡的驱动
</p>
<div class="org-src-container">
<pre class="src src-shell">pacman -Ss xf86-video |less
</pre>
</div>
<p>
Intel 集成显卡：
</p>
<div class="org-src-container">
<pre class="src src-shell">pacman -S xf86-video-intel
</pre>
</div>
<p>
虚拟机显卡：
</p>
<div class="org-src-container">
<pre class="src src-shell">pacman -S xf86-video-vesa
</pre>
</div>
<p>
笔记本触摸板驱动 (老家伙是台式，不需要了):
</p>
<div class="org-src-container">
<pre class="src src-shell">pacman -S xf86-input-synaptics
</pre>
</div>
<p>
安装输入法
</p>
<div class="org-src-container">
<pre class="src src-shell">pacman -S scim-pinyin
</pre>
</div>
<p>
先安装 slim(图像登录管理器)
</p>
<div class="org-src-container">
<pre class="src src-shell">pacman -S slim
</pre>
</div>
<p>
安装xfce4
</p>
<div class="org-src-container">
<pre class="src src-shell">pacman -S xfce4
</pre>
</div>
<p>
启动xfce4
</p>
<div class="org-src-container">
<pre class="src src-shell">startxfce4
</pre>
</div>

<p>
基本就大功告成了，因为笔者的台式电脑是bios, 所以不用折腾uefi, 还有无线网络。
<b>Action is louder than words</b>,还是多动手才行，笔者都装了三次才成功，内核空指
针和段错误都遇到了 :）
</p>
</div>
</div>
</div>
<div id="outline-container-org0484b8e" class="outline-3">
<h3 id="org0484b8e">参考</h3>
<div class="outline-text-3" id="text-org0484b8e">
<p>
<a href="https://wiki.archlinux.org/index.php/installation_guide">https://wiki.archlinux.org/index.php/installation_guide</a>
</p>
</div>
</div>
</div>

    </div>
</section>


<footer id="footer">
    <br />
</footer>

  </body>
</html>
